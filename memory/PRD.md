# Transfers Admin Panel - PRD

## Original Problem Statement
إكمال لوحة تحكم Admin Panel لتطبيق ترانسفيرز - تطبيق مشابه لـ Careem/Uber يشمل خدمة الرحلات والتوصيل.

### آخر تحديث (2026-01-31)
- إضافة نظام النسخ الاحتياطي لقاعدة البيانات (تلقائي كل 6 ساعات + يدوي)
- إضافة خاصية الستوري (Stories) 
- إضافة التخزين السحابي (Cloud Storage)
- إضافة تبويب الأرشيف
- تحسين نظام تسجيل الدخول للتحقق من المستخدمين المسجلين فقط

## What's Been Implemented

### Database Backup System (NEW)
- ✅ **النسخ الاحتياطي التلقائي** - كل 6 ساعات (قابل للتعديل: 1، 3، 6، 12، 24 ساعة)
- ✅ **النسخ الاحتياطي اليدوي** - زر "نسخ احتياطي الآن"
- ✅ **استعادة النسخ** - استعادة قاعدة البيانات من أي نسخة سابقة
- ✅ **حذف النسخ** - حذف النسخ القديمة
- ✅ **عرض قائمة النسخ** - مع الحجم والتاريخ والنوع
- ✅ **API Endpoints:**
  - `POST /api/backup/create` - إنشاء نسخة
  - `GET /api/backup/list` - عرض النسخ
  - `GET /api/backup/settings` - إعدادات النسخ
  - `PUT /api/backup/settings` - تحديث الإعدادات
  - `POST /api/backup/restore/{id}` - استعادة نسخة
  - `DELETE /api/backup/{id}` - حذف نسخة

### Login System Update
- ✅ التحقق من المستخدمين المسجلين فقط
- ✅ رسالة "البريد الإلكتروني غير مسجل" للبريد غير الموجود
- ✅ رسالة "كلمة المرور غير صحيحة" لكلمة المرور الخاطئة

### Registered Accounts
| البريد | كلمة المرور | النوع |
|--------|-------------|-------|
| `test@test.com` | `test123` | راكب |
| `rider@transfers.com` | `rider123` | راكب |
| `driver@transfers.com` | `driver123` | سائق |
| `admin@transfers.com` | `admin123` | مدير |

## Technical Stack
- **Frontend**: React, Tailwind CSS, Shadcn/UI
- **Backend**: FastAPI
- **Database**: MongoDB
- **Backup Storage**: `/app/backend/backups/`

## Next Tasks
1. [ ] ربط واجهة النسخ الاحتياطي مع Backend (إصلاح مشكلة الجلسة)
2. [ ] إضافة تنزيل ملفات النسخ الاحتياطي
3. [ ] إضافة إشعارات عند اكتمال النسخ التلقائي

## User Personas
1. **مدير النظام (Super Admin)**: صلاحيات كاملة لإدارة جميع جوانب التطبيق
2. **مشرف العمليات**: مراقبة الرحلات والطلبات
3. **مدير التسويق**: إدارة العروض والكوبونات
4. **المستخدم العادي**: استخدام تطبيق الدردشة والرحلات

## Core Requirements (Static)
- ✅ تسجيل دخول آمن للمشرفين
- ✅ لوحة تحكم بإحصائيات ورسوم بيانية
- ✅ إدارة المستخدمين (عرض، تفعيل، حظر)
- ✅ إدارة السائقين (عرض، توثيق، تفعيل/إيقاف)
- ✅ إدارة المطاعم (عرض، فتح/إغلاق)
- ✅ متابعة الرحلات
- ✅ متابعة الطلبات
- ✅ إدارة العروض والكوبونات (CRUD)
- ✅ صفحة الإعدادات
- ✅ دعم RTL للغة العربية
- ✅ تصميم Dark Theme عصري

## What's Been Implemented (2026-01-31)

### New Features - Chat Page
- ✅ **خاصية الستوري (Stories)**
  - عرض ستوريات المستخدمين في الشريط العلوي
  - عارض ستوري متكامل (Story Viewer) مع شريط تقدم
  - إضافة ستوري جديد (صورة أو نص مع ألوان متعددة)
  - عرض عدد المشاهدات
  
- ✅ **التخزين السحابي (Cloud Storage)**
  - عرض المساحة المستخدمة
  - فلترة الملفات حسب النوع (صور، فيديو، صوت، مستندات)
  - رفع ملفات جديدة
  - حذف الملفات
  
- ✅ **تبويب الأرشيف**
  - تبويب منفصل للمحادثات المؤرشفة
  - عداد للمحادثات المؤرشفة
  - إمكانية إلغاء الأرشفة
  
- ✅ **تحسينات الرسائل**
  - تعديل الرسائل
  - حذف الرسائل (من طرف واحد أو الطرفين)
  - قائمة سياق محسنة

### Previous Features
- صفحة الدردشة بتصميم Telegram الاحترافي
- تصميم متوافق مع الهاتف (Mobile Responsive)
- رسالة خطأ واضحة عند كلمة المرور الخاطئة
- صفحة استعادة كلمة المرور عبر رقم الهاتف
- زر لوحة التحكم للمدير

### Pages
- `/login` - صفحة تسجيل الدخول
- `/forgot-password` - صفحة استعادة كلمة المرور
- `/chat` - صفحة الدردشة (مع ستوري وتخزين سحابي)
- `/admin` - لوحة التحكم الرئيسية
- `/admin/users` - إدارة المستخدمين
- `/admin/drivers` - إدارة السائقين
- `/admin/restaurants` - إدارة المطاعم
- `/admin/rides` - متابعة الرحلات
- `/admin/orders` - متابعة الطلبات
- `/admin/promotions` - إدارة العروض
- `/admin/settings` - الإعدادات

## Prioritized Backlog

### P0 - Critical (Next Phase)
1. ربط Backend مع MongoDB APIs
2. نظام المصادقة JWT الحقيقي
3. إدارة الجلسات والتوكنات

### P1 - High Priority
1. تخزين الستوريات في قاعدة البيانات
2. رفع الملفات الفعلي للتخزين السحابي
3. إشعارات Real-time للستوريات الجديدة

### P2 - Medium Priority
1. Google Maps Integration للخرائط
2. نظام الدفع الحقيقي
3. دعم اللغة الإنجليزية الكامل

## Technical Stack
- **Frontend**: React, Tailwind CSS, Shadcn/UI
- **Backend**: FastAPI (جاهز للربط)
- **Database**: MongoDB (جاهز للربط)
- **Icons**: Lucide React

## Next Tasks
1. [ ] ربط Stories API مع Backend
2. [ ] تنفيذ Cloud Storage API الفعلي
3. [ ] إضافة WebSocket للتحديثات الفورية
